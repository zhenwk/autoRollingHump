/// \file ConicalSidewind.h
/// \brief Conical sidewinding gait, that turns in an arc corresponding to a
///        certain radius.

#ifndef CONICALSIDEWIND_H
#define CONICALSIDEWIND_H

#include "Gait.h"
#include <assert.h>

enum Radius {R1,R6,R11,R16,R20,Rn1,Rn6,Rn11,Rn16,Rn20};

/// \brief Conical Sidewinding motion.
class ConicalSidewind:public Gait{
	private:
	// The direction is simply +/- 1:
	int dir;
	// Positive or Negative Radius
	int radSign;
	// The constants
	double p[7][2][16];

	public:
	/// Gait constructor sets the number of modules and the direction of motion.
	// TODO: should part or all of this move to the parent class?
	ConicalSidewind(int numModulesIn, GaitDirection directionIn, Radius radius){
		numModules = numModulesIn;
		if (directionIn == GAIT_DIR_LEFT) {
			dir = +1;
		} else if (directionIn == GAIT_DIR_RIGHT) {
			dir = -1;
		} else {
			fprintf(stderr,"Invalid direction selected.  Setting LEFT\n");
			dir = +1;
		}
		if (numModules != 16) {
			fprintf(stderr,"Error: number of modules must be 16 for conical sidewinding!\n");
			assert(0);
		}

		radSign = -1;
		switch (radius) {
			case (R1):
				radSign = +1;
			case (Rn1):
				p[0][0][0]=0.45732;p[0][0][1]=0.66525;p[0][0][2]=0.068932;p[0][0][3]=0.65046;p[0][0][4]=0.78656;p[0][0][5]=0.080006;p[0][0][6]=0.6856;p[0][0][7]=0.68074;p[0][0][8]=0.25091;p[0][0][9]=0.51253;p[0][0][10]=0.71562;p[0][0][11]=0.47029;p[0][0][12]=0.11089;p[0][0][13]=0.34952;p[0][0][14]=0.38277;p[0][0][15]=0.35757;p[0][1][0]=3.1416;p[0][1][1]=0;p[0][1][2]=3.1416;p[0][1][3]=0;p[0][1][4]=0;p[0][1][5]=0;p[0][1][6]=0;p[0][1][7]=3.1416;p[0][1][8]=3.1416;p[0][1][9]=3.1416;p[0][1][10]=3.1416;p[0][1][11]=0;p[0][1][12]=0;p[0][1][13]=0;p[0][1][14]=0;p[0][1][15]=3.1416;
				p[1][0][0]=0.0066259;p[1][0][1]=0.01253;p[1][0][2]=0.006932;p[1][0][3]=0.0031287;p[1][0][4]=0.011589;p[1][0][5]=0.010813;p[1][0][6]=0.0043711;p[1][0][7]=0.0048238;p[1][0][8]=0.0090324;p[1][0][9]=0.010445;p[1][0][10]=0.0053143;p[1][0][11]=0.0076075;p[1][0][12]=0.0067459;p[1][0][13]=0.0069698;p[1][0][14]=0.0045578;p[1][0][15]=0.0017523;p[1][1][0]=0.92369;p[1][1][1]=0.013206;p[1][1][2]=2.4623;p[1][1][3]=0.6997;p[1][1][4]=-2.6824;p[1][1][5]=2.9391;p[1][1][6]=0.22593;p[1][1][7]=-2.303;p[1][1][8]=-0.19235;p[1][1][9]=-0.69222;p[1][1][10]=2.4673;p[1][1][11]=1.1731;p[1][1][12]=-2.6465;p[1][1][13]=3.0914;p[1][1][14]=-0.1061;p[1][1][15]=-1.1352;
				p[2][0][0]=0.44077;p[2][0][1]=0.51043;p[2][0][2]=0.35657;p[2][0][3]=0.62424;p[2][0][4]=0.53164;p[2][0][5]=0.43403;p[2][0][6]=0.50954;p[2][0][7]=0.40836;p[2][0][8]=0.60344;p[2][0][9]=0.44715;p[2][0][10]=0.37701;p[2][0][11]=0.30758;p[2][0][12]=0.49601;p[2][0][13]=0.2815;p[2][0][14]=0.25884;p[2][0][15]=0.20524;p[2][1][0]=1.5668;p[2][1][1]=-0.44803;p[2][1][2]=2.424;p[2][1][3]=1.2236;p[2][1][4]=-2.9435;p[2][1][5]=2.5297;p[2][1][6]=-1.1359;p[2][1][7]=-2.1249;p[2][1][8]=0.48549;p[2][1][9]=-0.62398;p[2][1][10]=2.0286;p[2][1][11]=1.4755;p[2][1][12]=-2.4115;p[2][1][13]=2.8672;p[2][1][14]=-0.22157;p[2][1][15]=-1.0874;
				p[3][0][0]=0.007803;p[3][0][1]=0.0067888;p[3][0][2]=0.003596;p[3][0][3]=0.014863;p[3][0][4]=0.0064455;p[3][0][5]=0.0048106;p[3][0][6]=0.0052149;p[3][0][7]=0.0085388;p[3][0][8]=0.0083243;p[3][0][9]=0.0050988;p[3][0][10]=0.007041;p[3][0][11]=0.0060906;p[3][0][12]=0.0083033;p[3][0][13]=0.0032379;p[3][0][14]=0.0013775;p[3][0][15]=0.0081942;p[3][1][0]=-0.86151;p[3][1][1]=1.7209;p[3][1][2]=-1.6996;p[3][1][3]=-1.906;p[3][1][4]=0.84594;p[3][1][5]=-1.3112;p[3][1][6]=0.65918;p[3][1][7]=1.4761;p[3][1][8]=-2.5644;p[3][1][9]=0.66443;p[3][1][10]=-1.9554;p[3][1][11]=-2.3444;p[3][1][12]=0.98514;p[3][1][13]=-1.3508;p[3][1][14]=-0.49629;p[3][1][15]=1.485;
				p[4][0][0]=0.12217;p[4][0][1]=0.085183;p[4][0][2]=0.11871;p[4][0][3]=0.07817;p[4][0][4]=0.046344;p[4][0][5]=0.10908;p[4][0][6]=0.090464;p[4][0][7]=0.067427;p[4][0][8]=0.041682;p[4][0][9]=0.11717;p[4][0][10]=0.078926;p[4][0][11]=0.08508;p[4][0][12]=0.033606;p[4][0][13]=0.084304;p[4][0][14]=0.057053;p[4][0][15]=0.048779;p[4][1][0]=0.40724;p[4][1][1]=-0.12428;p[4][1][2]=2.2137;p[4][1][3]=1.8444;p[4][1][4]=-1.8463;p[4][1][5]=-2.9013;p[4][1][6]=-1.013;p[4][1][7]=-1.9058;p[4][1][8]=1.1608;p[4][1][9]=0.1431;p[4][1][10]=2.4554;p[4][1][11]=1.687;p[4][1][12]=-1.6658;p[4][1][13]=-2.5083;p[4][1][14]=-0.4879;p[4][1][15]=-0.753;
				p[5][0][0]=0.0048689;p[5][0][1]=0.0075902;p[5][0][2]=0.0057294;p[5][0][3]=0.014309;p[5][0][4]=0.0036786;p[5][0][5]=0.0036771;p[5][0][6]=0.010272;p[5][0][7]=0.0052071;p[5][0][8]=0.01099;p[5][0][9]=0.012542;p[5][0][10]=0.0072558;p[5][0][11]=0.0035245;p[5][0][12]=0.012879;p[5][0][13]=0.0078689;p[5][0][14]=0.0061036;p[5][0][15]=0.0036977;p[5][1][0]=-2.3097;p[5][1][1]=2.059;p[5][1][2]=-0.32965;p[5][1][3]=-1.4481;p[5][1][4]=0.74017;p[5][1][5]=-0.95195;p[5][1][6]=2.4283;p[5][1][7]=2.9381;p[5][1][8]=-1.8728;p[5][1][9]=0.935;p[5][1][10]=-0.77328;p[5][1][11]=-0.73007;p[5][1][12]=0.96777;p[5][1][13]=-2.2975;p[5][1][14]=-3.0837;p[5][1][15]=2.22;
				p[6][0][0]=0.020602;p[6][0][1]=0.021684;p[6][0][2]=0.010016;p[6][0][3]=0.01655;p[6][0][4]=0.015895;p[6][0][5]=0.041917;p[6][0][6]=0.017509;p[6][0][7]=0.010197;p[6][0][8]=0.018432;p[6][0][9]=0.031963;p[6][0][10]=0.010825;p[6][0][11]=0.013743;p[6][0][12]=0.019044;p[6][0][13]=0.024923;p[6][0][14]=0.013293;p[6][0][15]=0.0034127;p[6][1][0]=-0.88781;p[6][1][1]=1.0949;p[6][1][2]=-0.18394;p[6][1][3]=-0.45569;p[6][1][4]=-1.0971;p[6][1][5]=2.0157;p[6][1][6]=1.7899;p[6][1][7]=1.883;p[6][1][8]=2.3612;p[6][1][9]=-1.1027;p[6][1][10]=-0.77621;p[6][1][11]=-0.76317;p[6][1][12]=-0.75813;p[6][1][13]=2.2315;p[6][1][14]=2.61;p[6][1][15]=2.806;
				break;
			case (R6):
				radSign = +1;
			case (Rn6):
				p[0][0][0]=0.43878;p[0][0][1]=0.69679;p[0][0][2]=0.041494;p[0][0][3]=0.59866;p[0][0][4]=0.83107;p[0][0][5]=0.13752;p[0][0][6]=0.53092;p[0][0][7]=0.7407;p[0][0][8]=0.46687;p[0][0][9]=0.28374;p[0][0][10]=0.63029;p[0][0][11]=0.60567;p[0][0][12]=0.26915;p[0][0][13]=0.24244;p[0][0][14]=0.41633;p[0][0][15]=0.41648;p[0][1][0]=3.1416;p[0][1][1]=0;p[0][1][2]=0;p[0][1][3]=0;p[0][1][4]=0;p[0][1][5]=3.1416;p[0][1][6]=0;p[0][1][7]=3.1416;p[0][1][8]=3.1416;p[0][1][9]=3.1416;p[0][1][10]=3.1416;p[0][1][11]=0;p[0][1][12]=0;p[0][1][13]=0;p[0][1][14]=0;p[0][1][15]=3.1416;
				p[1][0][0]=0.0050752;p[1][0][1]=0.010584;p[1][0][2]=0.0080515;p[1][0][3]=0.006722;p[1][0][4]=0.0088121;p[1][0][5]=0.0073001;p[1][0][6]=0.010295;p[1][0][7]=0.0042078;p[1][0][8]=0.0096341;p[1][0][9]=0.006928;p[1][0][10]=0.0088394;p[1][0][11]=0.0037195;p[1][0][12]=0.0085624;p[1][0][13]=0.0048754;p[1][0][14]=0.0087788;p[1][0][15]=0.0069719;p[1][1][0]=1.1885;p[1][1][1]=-0.25052;p[1][1][2]=2.8742;p[1][1][3]=1.1389;p[1][1][4]=-3.1038;p[1][1][5]=2.7439;p[1][1][6]=-0.4656;p[1][1][7]=-2.1762;p[1][1][8]=0.27897;p[1][1][9]=-0.53991;p[1][1][10]=2.7012;p[1][1][11]=2.1577;p[1][1][12]=-2.7281;p[1][1][13]=2.6055;p[1][1][14]=-0.12473;p[1][1][15]=-0.75978;
				p[2][0][0]=0.41151;p[2][0][1]=0.50345;p[2][0][2]=0.37282;p[2][0][3]=0.58165;p[2][0][4]=0.51806;p[2][0][5]=0.42974;p[2][0][6]=0.49582;p[2][0][7]=0.44206;p[2][0][8]=0.53839;p[2][0][9]=0.44151;p[2][0][10]=0.40136;p[2][0][11]=0.351;p[2][0][12]=0.47818;p[2][0][13]=0.29501;p[2][0][14]=0.31661;p[2][0][15]=0.24633;p[2][1][0]=1.5367;p[2][1][1]=-0.30646;p[2][1][2]=2.384;p[2][1][3]=1.366;p[2][1][4]=-2.7985;p[2][1][5]=2.7175;p[2][1][6]=-0.88971;p[2][1][7]=-1.9303;p[2][1][8]=0.64323;p[2][1][9]=-0.42048;p[2][1][10]=2.3648;p[2][1][11]=1.6051;p[2][1][12]=-2.279;p[2][1][13]=3.0506;p[2][1][14]=-0.22826;p[2][1][15]=-1.1815;
				p[3][0][0]=0.0087842;p[3][0][1]=0.0033273;p[3][0][2]=0.0043272;p[3][0][3]=0.012411;p[3][0][4]=0.0068014;p[3][0][5]=0.0022636;p[3][0][6]=0.008839;p[3][0][7]=0.0076199;p[3][0][8]=0.0083201;p[3][0][9]=0.0033558;p[3][0][10]=0.0062953;p[3][0][11]=0.0073185;p[3][0][12]=0.0083441;p[3][0][13]=0.0015246;p[3][0][14]=0.0029144;p[3][0][15]=0.0048938;p[3][1][0]=-1.1283;p[3][1][1]=1.6596;p[3][1][2]=-1.2158;p[3][1][3]=-2.0796;p[3][1][4]=0.52647;p[3][1][5]=-1.0472;p[3][1][6]=1.9667;p[3][1][7]=1.4939;p[3][1][8]=-2.348;p[3][1][9]=0.71096;p[3][1][10]=-1.3282;p[3][1][11]=-1.6291;p[3][1][12]=0.89575;p[3][1][13]=2.01;p[3][1][14]=2.5418;p[3][1][15]=2.1328;
				p[4][0][0]=0.10783;p[4][0][1]=0.057177;p[4][0][2]=0.088765;p[4][0][3]=0.029765;p[4][0][4]=0.04941;p[4][0][5]=0.092812;p[4][0][6]=0.068743;p[4][0][7]=0.053726;p[4][0][8]=0.024179;p[4][0][9]=0.094482;p[4][0][10]=0.048525;p[4][0][11]=0.051843;p[4][0][12]=0.022568;p[4][0][13]=0.070492;p[4][0][14]=0.047316;p[4][0][15]=0.033493;p[4][1][0]=0.42185;p[4][1][1]=0.2749;p[4][1][2]=2.2198;p[4][1][3]=2.1738;p[4][1][4]=-2.0957;p[4][1][5]=-3.0057;p[4][1][6]=-0.81845;p[4][1][7]=-1.8245;p[4][1][8]=2.0291;p[4][1][9]=0.4127;p[4][1][10]=2.4274;p[4][1][11]=1.9281;p[4][1][12]=-1.5888;p[4][1][13]=-2.4029;p[4][1][14]=-0.4922;p[4][1][15]=-0.73081;
				p[5][0][0]=0.0051688;p[5][0][1]=0.0056702;p[5][0][2]=0.0040529;p[5][0][3]=0.013313;p[5][0][4]=0.0040024;p[5][0][5]=0.0042832;p[5][0][6]=0.0058003;p[5][0][7]=0.0052422;p[5][0][8]=0.0077133;p[5][0][9]=0.0062454;p[5][0][10]=0.0039413;p[5][0][11]=0.0044772;p[5][0][12]=0.0084038;p[5][0][13]=0.0050493;p[5][0][14]=0.0018563;p[5][0][15]=0.0069576;p[5][1][0]=-2.0753;p[5][1][1]=1.5993;p[5][1][2]=-1.0474;p[5][1][3]=-1.7155;p[5][1][4]=0.98582;p[5][1][5]=-0.56977;p[5][1][6]=2.1282;p[5][1][7]=1.6556;p[5][1][8]=-1.6013;p[5][1][9]=1.4927;p[5][1][10]=-1.3007;p[5][1][11]=-1.5081;p[5][1][12]=1.4151;p[5][1][13]=-1.8935;p[5][1][14]=2.9707;p[5][1][15]=1.3075;
				p[6][0][0]=0.019552;p[6][0][1]=0.017411;p[6][0][2]=0.0080005;p[6][0][3]=0.015923;p[6][0][4]=0.016808;p[6][0][5]=0.023632;p[6][0][6]=0.019934;p[6][0][7]=0.0040681;p[6][0][8]=0.005559;p[6][0][9]=0.014456;p[6][0][10]=0.0069279;p[6][0][11]=0.0040021;p[6][0][12]=0.005239;p[6][0][13]=0.0066948;p[6][0][14]=0.0066161;p[6][0][15]=0.0038423;p[6][1][0]=-0.82199;p[6][1][1]=2.1568;p[6][1][2]=0.49473;p[6][1][3]=-0.02213;p[6][1][4]=-0.89713;p[6][1][5]=2.4165;p[6][1][6]=1.8004;p[6][1][7]=2.474;p[6][1][8]=2.79;p[6][1][9]=-1.2308;p[6][1][10]=-1.3783;p[6][1][11]=-2.6086;p[6][1][12]=-0.4405;p[6][1][13]=1.5859;p[6][1][14]=2.7288;p[6][1][15]=0.35832;
				break;
			case (R11):
				radSign = +1;
			case (Rn11):
				p[0][0][0]=0.4084;p[0][0][1]=0.70876;p[0][0][2]=0.14943;p[0][0][3]=0.5147;p[0][0][4]=0.83921;p[0][0][5]=0.33806;p[0][0][6]=0.33089;p[0][0][7]=0.73059;p[0][0][8]=0.61942;p[0][0][9]=0.042502;p[0][0][10]=0.51413;p[0][0][11]=0.68641;p[0][0][12]=0.41849;p[0][0][13]=0.13638;p[0][0][14]=0.4488;p[0][0][15]=0.51031;p[0][1][0]=3.1416;p[0][1][1]=0;p[0][1][2]=0;p[0][1][3]=0;p[0][1][4]=0;p[0][1][5]=3.1416;p[0][1][6]=0;p[0][1][7]=3.1416;p[0][1][8]=3.1416;p[0][1][9]=3.1416;p[0][1][10]=3.1416;p[0][1][11]=0;p[0][1][12]=0;p[0][1][13]=0;p[0][1][14]=0;p[0][1][15]=3.1416;
				p[1][0][0]=0.0052451;p[1][0][1]=0.010562;p[1][0][2]=0.007076;p[1][0][3]=0.0068576;p[1][0][4]=0.0090829;p[1][0][5]=0.011468;p[1][0][6]=0.009701;p[1][0][7]=0.006007;p[1][0][8]=0.0075637;p[1][0][9]=0.0074697;p[1][0][10]=0.0082374;p[1][0][11]=0.0031492;p[1][0][12]=0.0052738;p[1][0][13]=0.0087512;p[1][0][14]=0.0028204;p[1][0][15]=0.0059566;p[1][1][0]=1.1557;p[1][1][1]=-0.10902;p[1][1][2]=3.0051;p[1][1][3]=1.1656;p[1][1][4]=-2.959;p[1][1][5]=2.9474;p[1][1][6]=-0.31171;p[1][1][7]=-1.3465;p[1][1][8]=0.62374;p[1][1][9]=-0.31974;p[1][1][10]=2.9159;p[1][1][11]=1.7064;p[1][1][12]=-1.4724;p[1][1][13]=2.8573;p[1][1][14]=-2.9534;p[1][1][15]=-0.53119;
				p[2][0][0]=0.37684;p[2][0][1]=0.48029;p[2][0][2]=0.3906;p[2][0][3]=0.54914;p[2][0][4]=0.49203;p[2][0][5]=0.42544;p[2][0][6]=0.47718;p[2][0][7]=0.46874;p[2][0][8]=0.48767;p[2][0][9]=0.4328;p[2][0][10]=0.42879;p[2][0][11]=0.38931;p[2][0][12]=0.46166;p[2][0][13]=0.34126;p[2][0][14]=0.36739;p[2][0][15]=0.30124;p[2][1][0]=1.4928;p[2][1][1]=-0.19268;p[2][1][2]=2.3917;p[2][1][3]=1.4652;p[2][1][4]=-2.6382;p[2][1][5]=2.8979;p[2][1][6]=-0.71066;p[2][1][7]=-1.6981;p[2][1][8]=0.773;p[2][1][9]=-0.21389;p[2][1][10]=2.5927;p[2][1][11]=1.6887;p[2][1][12]=-2.1234;p[2][1][13]=-3.1071;p[2][1][14]=-0.2193;p[2][1][15]=-1.2404;
				p[3][0][0]=0.0078603;p[3][0][1]=0.0053874;p[3][0][2]=0.0048949;p[3][0][3]=0.0088411;p[3][0][4]=0.0045595;p[3][0][5]=0.0042541;p[3][0][6]=0.006551;p[3][0][7]=0.0083769;p[3][0][8]=0.007485;p[3][0][9]=0.0029272;p[3][0][10]=0.0058225;p[3][0][11]=0.0070331;p[3][0][12]=0.011415;p[3][0][13]=0.0031939;p[3][0][14]=0.014685;p[3][0][15]=0.0041462;p[3][1][0]=-1.1567;p[3][1][1]=2.6704;p[3][1][2]=-0.67215;p[3][1][3]=-1.5808;p[3][1][4]=0.67515;p[3][1][5]=-1.2092;p[3][1][6]=2.2402;p[3][1][7]=1.7377;p[3][1][8]=-2.3382;p[3][1][9]=2.5166;p[3][1][10]=-0.79497;p[3][1][11]=-1.571;p[3][1][12]=0.64705;p[3][1][13]=0.40876;p[3][1][14]=3.0819;p[3][1][15]=1.6472;
				p[4][0][0]=0.091271;p[4][0][1]=0.034388;p[4][0][2]=0.070202;p[4][0][3]=0.01186;p[4][0][4]=0.049052;p[4][0][5]=0.082257;p[4][0][6]=0.049819;p[4][0][7]=0.03485;p[4][0][8]=0.010234;p[4][0][9]=0.078964;p[4][0][10]=0.035322;p[4][0][11]=0.033773;p[4][0][12]=0.015358;p[4][0][13]=0.065478;p[4][0][14]=0.029796;p[4][0][15]=0.03118;p[4][1][0]=0.42566;p[4][1][1]=0.50682;p[4][1][2]=2.214;p[4][1][3]=2.6712;p[4][1][4]=-2.0366;p[4][1][5]=-3.0323;p[4][1][6]=-1.1074;p[4][1][7]=-1.5793;p[4][1][8]=2.2435;p[4][1][9]=0.43294;p[4][1][10]=2.2526;p[4][1][11]=1.8133;p[4][1][12]=-0.49923;p[4][1][13]=-2.5713;p[4][1][14]=-0.965;p[4][1][15]=-0.96373;
				p[5][0][0]=0.004446;p[5][0][1]=0.0021576;p[5][0][2]=0.0040089;p[5][0][3]=0.0041038;p[5][0][4]=0.0051062;p[5][0][5]=0.0076614;p[5][0][6]=0.0035889;p[5][0][7]=0.0077313;p[5][0][8]=0.0036265;p[5][0][9]=0.0048153;p[5][0][10]=0.0024807;p[5][0][11]=0.0047486;p[5][0][12]=0.0078244;p[5][0][13]=0.0063722;p[5][0][14]=0.011282;p[5][0][15]=0.0031009;p[5][1][0]=-2.047;p[5][1][1]=-3.1242;p[5][1][2]=-1.6575;p[5][1][3]=-1.5893;p[5][1][4]=0.85271;p[5][1][5]=-0.37813;p[5][1][6]=1.6234;p[5][1][7]=1.9493;p[5][1][8]=-1.8223;p[5][1][9]=2.988;p[5][1][10]=-1.857;p[5][1][11]=-1.8903;p[5][1][12]=0.72105;p[5][1][13]=-0.031782;p[5][1][14]=-3.1071;p[5][1][15]=1.5315;
				p[6][0][0]=0.018163;p[6][0][1]=0.010189;p[6][0][2]=0.005781;p[6][0][3]=0.0011849;p[6][0][4]=0.016994;p[6][0][5]=0.016046;p[6][0][6]=0.022993;p[6][0][7]=0.0039514;p[6][0][8]=0.0058421;p[6][0][9]=0.012189;p[6][0][10]=0.015074;p[6][0][11]=0.0056144;p[6][0][12]=0.01883;p[6][0][13]=0.0048964;p[6][0][14]=0.019908;p[6][0][15]=0.0086086;p[6][1][0]=-0.69111;p[6][1][1]=2.4986;p[6][1][2]=-0.29243;p[6][1][3]=2.2238;p[6][1][4]=-0.10264;p[6][1][5]=3.0203;p[6][1][6]=2.4212;p[6][1][7]=0.26841;p[6][1][8]=2.8846;p[6][1][9]=-0.27017;p[6][1][10]=-1.3235;p[6][1][11]=-2.1774;p[6][1][12]=0.1463;p[6][1][13]=2.9756;p[6][1][14]=2.8314;p[6][1][15]=1.4557;
				break;
			case (R16):
				radSign = +1;
			case (Rn16):
				p[0][0][0]=0.36913;p[0][0][1]=0.70751;p[0][0][2]=0.24329;p[0][0][3]=0.39196;p[0][0][4]=0.80387;p[0][0][5]=0.49764;p[0][0][6]=0.11006;p[0][0][7]=0.65938;p[0][0][8]=0.71537;p[0][0][9]=0.19658;p[0][0][10]=0.37621;p[0][0][11]=0.72075;p[0][0][12]=0.55082;p[0][0][13]=0.026452;p[0][0][14]=0.49004;p[0][0][15]=0.601;p[0][1][0]=3.1416;p[0][1][1]=0;p[0][1][2]=0;p[0][1][3]=0;p[0][1][4]=0;p[0][1][5]=3.1416;p[0][1][6]=0;p[0][1][7]=3.1416;p[0][1][8]=3.1416;p[0][1][9]=0;p[0][1][10]=3.1416;p[0][1][11]=0;p[0][1][12]=0;p[0][1][13]=0;p[0][1][14]=0;p[0][1][15]=3.1416;
				p[1][0][0]=0.0053204;p[1][0][1]=0.0091586;p[1][0][2]=0.007605;p[1][0][3]=0.005044;p[1][0][4]=0.009134;p[1][0][5]=0.0087556;p[1][0][6]=0.01022;p[1][0][7]=0.0053924;p[1][0][8]=0.0067548;p[1][0][9]=0.0080798;p[1][0][10]=0.0092586;p[1][0][11]=0.0050032;p[1][0][12]=0.0069874;p[1][0][13]=0.0048374;p[1][0][14]=0.009347;p[1][0][15]=0.003119;p[1][1][0]=0.95858;p[1][1][1]=-0.025012;p[1][1][2]=2.8098;p[1][1][3]=1.0646;p[1][1][4]=-2.802;p[1][1][5]=3.0436;p[1][1][6]=-0.27093;p[1][1][7]=-1.8087;p[1][1][8]=0.56624;p[1][1][9]=0.059436;p[1][1][10]=3.009;p[1][1][11]=2.0084;p[1][1][12]=-2.5355;p[1][1][13]=-2.9492;p[1][1][14]=-0.13077;p[1][1][15]=-1.4274;
				p[2][0][0]=0.34555;p[2][0][1]=0.44708;p[2][0][2]=0.40895;p[2][0][3]=0.49789;p[2][0][4]=0.46001;p[2][0][5]=0.42603;p[2][0][6]=0.47358;p[2][0][7]=0.47149;p[2][0][8]=0.45647;p[2][0][9]=0.42527;p[2][0][10]=0.45467;p[2][0][11]=0.42674;p[2][0][12]=0.45131;p[2][0][13]=0.3983;p[2][0][14]=0.43191;p[2][0][15]=0.36228;p[2][1][0]=1.4158;p[2][1][1]=-0.075221;p[2][1][2]=2.4089;p[2][1][3]=1.5275;p[2][1][4]=-2.4478;p[2][1][5]=3.0903;p[2][1][6]=-0.60482;p[2][1][7]=-1.4897;p[2][1][8]=0.85588;p[2][1][9]=0.05058;p[2][1][10]=2.6944;p[2][1][11]=1.8129;p[2][1][12]=-2.0469;p[2][1][13]=-2.9262;p[2][1][14]=-0.22114;p[2][1][15]=-1.3176;
				p[3][0][0]=0.0064453;p[3][0][1]=0.0049267;p[3][0][2]=0.005494;p[3][0][3]=0.0097619;p[3][0][4]=0.0047023;p[3][0][5]=0.0040856;p[3][0][6]=0.0064848;p[3][0][7]=0.0088491;p[3][0][8]=0.0079713;p[3][0][9]=0.0042955;p[3][0][10]=0.005372;p[3][0][11]=0.0071112;p[3][0][12]=0.0071255;p[3][0][13]=0.0049624;p[3][0][14]=0.0046124;p[3][0][15]=0.0073349;p[3][1][0]=-1.0983;p[3][1][1]=2.8294;p[3][1][2]=-1.0347;p[3][1][3]=-1.5026;p[3][1][4]=1.0327;p[3][1][5]=-0.18025;p[3][1][6]=2.1336;p[3][1][7]=1.8099;p[3][1][8]=-2.0515;p[3][1][9]=3.0936;p[3][1][10]=-0.56334;p[3][1][11]=-1.2718;p[3][1][12]=1.4493;p[3][1][13]=-0.16653;p[3][1][14]=2.7599;p[3][1][15]=1.8582;
				p[4][0][0]=0.068991;p[4][0][1]=0.015056;p[4][0][2]=0.048406;p[4][0][3]=0.0055741;p[4][0][4]=0.041221;p[4][0][5]=0.056747;p[4][0][6]=0.039636;p[4][0][7]=0.013297;p[4][0][8]=0.014203;p[4][0][9]=0.06071;p[4][0][10]=0.02668;p[4][0][11]=0.025096;p[4][0][12]=0.001399;p[4][0][13]=0.056352;p[4][0][14]=0.025073;p[4][0][15]=0.026976;p[4][1][0]=0.45929;p[4][1][1]=0.73846;p[4][1][2]=2.2598;p[4][1][3]=2.675;p[4][1][4]=-1.9976;p[4][1][5]=-2.8922;p[4][1][6]=-1.2761;p[4][1][7]=-1.2077;p[4][1][8]=1.2582;p[4][1][9]=0.46202;p[4][1][10]=2.0455;p[4][1][11]=1.6804;p[4][1][12]=1.8571;p[4][1][13]=-2.544;p[4][1][14]=-0.78258;p[4][1][15]=-1.2671;
				p[5][0][0]=0.0043065;p[5][0][1]=0.0014445;p[5][0][2]=0.0027161;p[5][0][3]=0.0053165;p[5][0][4]=0.002822;p[5][0][5]=0.0046049;p[5][0][6]=0.0042522;p[5][0][7]=0.0048073;p[5][0][8]=0.0055849;p[5][0][9]=0.0059483;p[5][0][10]=0.0015825;p[5][0][11]=0.0035678;p[5][0][12]=0.0036754;p[5][0][13]=0.0066084;p[5][0][14]=0.0011982;p[5][0][15]=0.0053069;p[5][1][0]=-2.267;p[5][1][1]=-3.0199;p[5][1][2]=-1.2955;p[5][1][3]=-1.177;p[5][1][4]=1.0496;p[5][1][5]=-0.037193;p[5][1][6]=1.3976;p[5][1][7]=2.0298;p[5][1][8]=-1.6568;p[5][1][9]=-2.9738;p[5][1][10]=-2.0311;p[5][1][11]=-1.1918;p[5][1][12]=1.8482;p[5][1][13]=0.015402;p[5][1][14]=1.8553;p[5][1][15]=1.67;
				p[6][0][0]=0.011409;p[6][0][1]=0.0072868;p[6][0][2]=0.0060888;p[6][0][3]=0.0057568;p[6][0][4]=0.013918;p[6][0][5]=0.0049588;p[6][0][6]=0.012356;p[6][0][7]=0.0057007;p[6][0][8]=0.0086589;p[6][0][9]=0.001062;p[6][0][10]=0.013427;p[6][0][11]=0.0062685;p[6][0][12]=0.010153;p[6][0][13]=0.0024888;p[6][0][14]=0.015324;p[6][0][15]=0.010044;p[6][1][0]=-0.80418;p[6][1][1]=3.0501;p[6][1][2]=-0.597;p[6][1][3]=-1.9334;p[6][1][4]=0.77556;p[6][1][5]=-2.9216;p[6][1][6]=2.7344;p[6][1][7]=0.41834;p[6][1][8]=-2.6076;p[6][1][9]=-0.64009;p[6][1][10]=-0.86774;p[6][1][11]=-1.791;p[6][1][12]=0.50845;p[6][1][13]=0.89663;p[6][1][14]=2.2766;p[6][1][15]=1.3083;
				break;
			case (R20):
				radSign = +1;
			case (Rn20):
				p[0][0][0]=0.31793;p[0][0][1]=0.68046;p[0][0][2]=0.31526;p[0][0][3]=0.23752;p[0][0][4]=0.71688;p[0][0][5]=0.61152;p[0][0][6]=0.13413;p[0][0][7]=0.49196;p[0][0][8]=0.74255;p[0][0][9]=0.45056;p[0][0][10]=0.13284;p[0][0][11]=0.65835;p[0][0][12]=0.69092;p[0][0][13]=0.21858;p[0][0][14]=0.37821;p[0][0][15]=0.66361;p[0][1][0]=3.1416;p[0][1][1]=0;p[0][1][2]=0;p[0][1][3]=0;p[0][1][4]=0;p[0][1][5]=3.1416;p[0][1][6]=3.1416;p[0][1][7]=3.1416;p[0][1][8]=3.1416;p[0][1][9]=0;p[0][1][10]=3.1416;p[0][1][11]=0;p[0][1][12]=0;p[0][1][13]=3.1416;p[0][1][14]=0;p[0][1][15]=3.1416;
				p[1][0][0]=0.003891;p[1][0][1]=0.010306;p[1][0][2]=0.0072329;p[1][0][3]=0.0038444;p[1][0][4]=0.0079487;p[1][0][5]=0.0079014;p[1][0][6]=0.0089644;p[1][0][7]=0.0041298;p[1][0][8]=0.0069557;p[1][0][9]=0.0097184;p[1][0][10]=0.009474;p[1][0][11]=0.0065145;p[1][0][12]=0.0046635;p[1][0][13]=0.011332;p[1][0][14]=0.0089259;p[1][0][15]=0.0045125;p[1][1][0]=1.0851;p[1][1][1]=0.0724;p[1][1][2]=2.5876;p[1][1][3]=2.2633;p[1][1][4]=-2.5188;p[1][1][5]=-3.0308;p[1][1][6]=-0.36038;p[1][1][7]=-1.0673;p[1][1][8]=0.72729;p[1][1][9]=0.20573;p[1][1][10]=3.0801;p[1][1][11]=2.0329;p[1][1][12]=-2.3;p[1][1][13]=-2.7799;p[1][1][14]=0.07539;p[1][1][15]=-0.60474;
				p[2][0][0]=0.31453;p[2][0][1]=0.40691;p[2][0][2]=0.40527;p[2][0][3]=0.44395;p[2][0][4]=0.42567;p[2][0][5]=0.41943;p[2][0][6]=0.47623;p[2][0][7]=0.44812;p[2][0][8]=0.43109;p[2][0][9]=0.41872;p[2][0][10]=0.46955;p[2][0][11]=0.44263;p[2][0][12]=0.4358;p[2][0][13]=0.42606;p[2][0][14]=0.461;p[2][0][15]=0.41341;p[2][1][0]=1.3346;p[2][1][1]=0.025286;p[2][1][2]=2.4495;p[2][1][3]=1.5982;p[2][1][4]=-2.2448;p[2][1][5]=-3.0197;p[2][1][6]=-0.48938;p[2][1][7]=-1.3254;p[2][1][8]=1.0498;p[2][1][9]=0.32914;p[2][1][10]=2.7936;p[2][1][11]=2.0438;p[2][1][12]=-1.9309;p[2][1][13]=-2.6555;p[2][1][14]=-0.15946;p[2][1][15]=-1.2062;
				p[3][0][0]=0.0058163;p[3][0][1]=0.003233;p[3][0][2]=0.0055316;p[3][0][3]=0.011033;p[3][0][4]=0.0060098;p[3][0][5]=0.0064463;p[3][0][6]=0.006252;p[3][0][7]=0.0089282;p[3][0][8]=0.0071273;p[3][0][9]=0.0046456;p[3][0][10]=0.0061035;p[3][0][11]=0.010113;p[3][0][12]=0.0076363;p[3][0][13]=0.0015216;p[3][0][14]=0.005391;p[3][0][15]=0.0064457;p[3][1][0]=-1.2469;p[3][1][1]=2.774;p[3][1][2]=-1.0299;p[3][1][3]=-1.8133;p[3][1][4]=1.1113;p[3][1][5]=0.24805;p[3][1][6]=2.5551;p[3][1][7]=1.6416;p[3][1][8]=-1.9887;p[3][1][9]=-2.9778;p[3][1][10]=-0.1716;p[3][1][11]=-1.0571;p[3][1][12]=1.3749;p[3][1][13]=1.0235;p[3][1][14]=-3.1353;p[3][1][15]=1.495;
				p[4][0][0]=0.043105;p[4][0][1]=0.0068943;p[4][0][2]=0.030273;p[4][0][3]=0.0059233;p[4][0][4]=0.033788;p[4][0][5]=0.027257;p[4][0][6]=0.027557;p[4][0][7]=0.0057317;p[4][0][8]=0.020554;p[4][0][9]=0.039804;p[4][0][10]=0.027596;p[4][0][11]=0.008985;p[4][0][12]=0.0056068;p[4][0][13]=0.0422;p[4][0][14]=0.018585;p[4][0][15]=0.021123;p[4][1][0]=0.50144;p[4][1][1]=1.0026;p[4][1][2]=2.2255;p[4][1][3]=-1.9649;p[4][1][4]=-1.9925;p[4][1][5]=-2.8332;p[4][1][6]=-1.2291;p[4][1][7]=0.24616;p[4][1][8]=1.2423;p[4][1][9]=0.61415;p[4][1][10]=2.0837;p[4][1][11]=1.4303;p[4][1][12]=-2.0735;p[4][1][13]=-2.4236;p[4][1][14]=-0.87583;p[4][1][15]=-1.5021;
				p[5][0][0]=0.0040079;p[5][0][1]=0.0013339;p[5][0][2]=0.0044369;p[5][0][3]=0.006643;p[5][0][4]=0.00476;p[5][0][5]=0.0045992;p[5][0][6]=0.003587;p[5][0][7]=0.0028423;p[5][0][8]=0.0039876;p[5][0][9]=0.0029477;p[5][0][10]=0.0054823;p[5][0][11]=0.0018327;p[5][0][12]=0.0036044;p[5][0][13]=0.0020818;p[5][0][14]=0.0045866;p[5][0][15]=0.0067457;p[5][1][0]=-2.1478;p[5][1][1]=1.5983;p[5][1][2]=-1.1189;p[5][1][3]=-1.6779;p[5][1][4]=1.4719;p[5][1][5]=0.83819;p[5][1][6]=2.2091;p[5][1][7]=2.1996;p[5][1][8]=-1.5976;p[5][1][9]=-1.8637;p[5][1][10]=-0.91555;p[5][1][11]=-0.23109;p[5][1][12]=1.9549;p[5][1][13]=2.2422;p[5][1][14]=2.0908;p[5][1][15]=1.5125;
				p[6][0][0]=0.0054549;p[6][0][1]=0.0049773;p[6][0][2]=0.0061458;p[6][0][3]=0.011218;p[6][0][4]=0.009253;p[6][0][5]=0.0043983;p[6][0][6]=0.0076346;p[6][0][7]=0.008884;p[6][0][8]=0.01049;p[6][0][9]=0.00087338;p[6][0][10]=0.012909;p[6][0][11]=0.011679;p[6][0][12]=0.012183;p[6][0][13]=0.0094946;p[6][0][14]=0.012368;p[6][0][15]=0.0049963;p[6][1][0]=-0.95108;p[6][1][1]=3.0752;p[6][1][2]=-0.57953;p[6][1][3]=-1.7111;p[6][1][4]=1.284;p[6][1][5]=-0.5412;p[6][1][6]=2.6578;p[6][1][7]=1.4411;p[6][1][8]=-2.0001;p[6][1][9]=-1.4371;p[6][1][10]=-0.6984;p[6][1][11]=-2.0472;p[6][1][12]=1.2769;p[6][1][13]=1.1023;p[6][1][14]=2.7092;p[6][1][15]=1.0868;
				break;
			default:
				fprintf(stderr,"Error: invalid radius selected.\n");
				for (int i=0;i<7;i++) {
					for (int j=0;j<7;j++) {
						for (int k=0;k<7;k++) {
							p[i][j][k] = 0.0;
						}
					}
				}
				break;
		}
	};

	std::vector<double> getAngles(double phase) {
		std::vector<double> angles(numModules,0.0);

		// Conical Sidewind equation -- an FFT used to compute the coefficients
		// for each radius.
		double f[7];
		for (int i=0;i<7;i++) {
			f[i] = -1*radSign*dir*2.0/M_PI*((double) i);
		}

		for (int j = 0; j< numModules; j++) {
			int mod;
			if (radSign == +1) {
				mod = numModules - j - 1;
			} else {
				mod = j;
			}
			angles[mod] = p[0][0][j]*cos(2*M_PI*f[0]*phase+p[0][1][j]) +
			              p[1][0][j]*cos(2*M_PI*f[1]*phase+p[1][1][j]) +
			              p[2][0][j]*cos(2*M_PI*f[2]*phase+p[2][1][j]) +
			              p[3][0][j]*cos(2*M_PI*f[3]*phase+p[3][1][j]) +
			              p[4][0][j]*cos(2*M_PI*f[4]*phase+p[4][1][j]) +
			              p[5][0][j]*cos(2*M_PI*f[5]*phase+p[5][1][j]) +
			              p[6][0][j]*cos(2*M_PI*f[6]*phase+p[6][1][j]);
		}
		return angles;
	};
};

#endif
